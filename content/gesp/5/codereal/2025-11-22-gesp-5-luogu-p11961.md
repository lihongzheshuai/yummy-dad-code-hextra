---
layout: post
title: 202503-åŸæ ¹åˆ¤æ–­(luogu-P11961)
date: 2025-11-22T08:00:00+0800
author: OneCoder
comments: true
tags:
- GESP
- C++
- æ•°è®º
categories:
- GESP
- äº”çº§
slug: gesp-5-luogu-p11961
type: docs
weight: 19
math: true
---
GESP C++ 2025å¹´3æœˆäº”çº§çœŸé¢˜ï¼Œæ•°è®ºè€ƒç‚¹ï¼Œå¯èƒ½å¾ˆè¶…çº²çš„é¢˜ç›®ï¼Œé¢˜ç›®éš¾åº¦â­â­â­â˜…â˜†ï¼Œäº”çº§æ¥è¯´å¾ˆéš¾ã€‚æ´›è°·éš¾åº¦ç­‰çº§`æé«˜+/çœé€‰âˆ’`

<!--more-->

## luogu-P11961 [GESP202503 äº”çº§] åŸæ ¹åˆ¤æ–­

### é¢˜ç›®è¦æ±‚

#### é¢˜ç›®èƒŒæ™¯

æˆªæ­¢ 2025 å¹´ 3 æœˆï¼Œæœ¬é¢˜å¯èƒ½è¶…å‡ºäº† GESP è€ƒçº²èŒƒå›´ã€‚åœ¨è¯¥æ—¶é—´ç‚¹ä¸‹ï¼ŒåŸæ ¹æ˜¯ NOI å¤§çº² 8 çº§çŸ¥è¯†ç‚¹ï¼ˆNOI çº§ï¼‰ï¼Œè€Œç›¸å¯¹ç®€å•çš„æ— éœ€åŸæ ¹çŸ¥è¯†çš„åšæ³•ä¸­ï¼Œä½¿ç”¨çš„è´¹é©¬å°å®šç†ä¸æ¬§æ‹‰å®šç†ä¹Ÿå±äº NOI å¤§çº² 7 çº§çŸ¥è¯†ç‚¹ï¼ˆæé«˜çº§ï¼‰ï¼Œä¸”å‡æœªå†™æ˜äº GESP å¤§çº²ä¸­ã€‚éœ€è¦æ³¨æ„ï¼ŒGESP å¤§çº²å’Œ NOI å¤§çº²æ˜¯ä¸åŒçš„å¤§çº²ã€‚

è‹¥å¯¹é¢˜ç›®ä¸­åŸæ ¹è¿™ä¸€æ¦‚å¿µæ„Ÿå…´è¶£ï¼Œå¯ä»¥å­¦ä¹ å®Œæˆ [ã€æ¨¡æ¿ã€‘åŸæ ¹](https://www.luogu.com.cn/problem/P6091)ã€‚

#### é¢˜ç›®æè¿°

>å° A çŸ¥é“ï¼Œå¯¹äºè´¨æ•° $p$ è€Œè¨€ï¼Œ$p$ çš„åŸæ ¹ $g$ æ˜¯æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æ­£æ•´æ•°ï¼š
>
>+ $1<g<p$ï¼›
>+ $g^{p-1}\bmod{p}=1$ï¼›
>+ å¯¹äºä»»æ„ $1\le i<p-1$ å‡æœ‰ $g^i\bmod{p}\neq1$ã€‚
>
>å…¶ä¸­ $a\bmod{p}$ è¡¨ç¤º $a$ é™¤ä»¥ $p$ çš„ä½™æ•°ã€‚
>
>å° A ç°åœ¨æœ‰ä¸€ä¸ªæ•´æ•° $a$ï¼Œè¯·ä½ å¸®ä»–åˆ¤æ–­ $a$ æ˜¯ä¸æ˜¯ $p$ çš„åŸæ ¹ã€‚

#### è¾“å…¥æ ¼å¼

>ç¬¬ä¸€è¡Œï¼Œä¸€ä¸ªæ­£æ•´æ•° $T$ï¼Œè¡¨ç¤ºæµ‹è¯•æ•°æ®ç»„æ•°ã€‚
>
>æ¯ç»„æµ‹è¯•æ•°æ®åŒ…å«ä¸€è¡Œï¼Œä¸¤ä¸ªæ­£æ•´æ•° $a,p$ã€‚

#### è¾“å‡ºæ ¼å¼

>å¯¹äºæ¯ç»„æµ‹è¯•æ•°æ®ï¼Œè¾“å‡ºä¸€è¡Œï¼Œå¦‚æœ $a$ æ˜¯ $p$ çš„åŸæ ¹åˆ™è¾“å‡º `Yes`ï¼Œå¦åˆ™è¾“å‡º `No`ã€‚

#### è¾“å…¥è¾“å‡ºæ ·ä¾‹ #1

##### è¾“å…¥ #1

```plaintext
3
3 998244353
5 998244353
7 998244353
```

##### è¾“å‡º #1

```plaintext
Yes
Yes
No
```

#### è¯´æ˜/æç¤º

##### æ•°æ®èŒƒå›´

å¯¹äº $40\%$ çš„æµ‹è¯•ç‚¹ï¼Œä¿è¯ $3\le p\le10^3$ã€‚

å¯¹äºæ‰€æœ‰æµ‹è¯•ç‚¹ï¼Œä¿è¯ $1\le T\le20$ï¼Œ$3\le p\le10^9$ï¼Œ$1<a<p$ï¼Œ$p$ ä¸ºè´¨æ•°ã€‚

---

### é¢˜ç›®åˆ†æ

è¯´å®è¯ï¼Œæˆ‘è§‰å¾—è¿™é“é¢˜æŒºæœçº²çš„ï¼Œå¯¹äºGESP5çº§ä½å¹´çº§è€ƒç”Ÿæ¥è¯´ï¼Œä¼¼ä¹è¿‡äºéš¾äº†ã€‚æˆ‘ä¹Ÿæ˜¯å­¦ä¹ äº†å¾ˆä¹…ï¼Œæ‰ç†è§£ç›¸å…³å®šç†ï¼Œç»™å‡ºä»£ç ç¤ºä¾‹çš„ã€‚

#### 1. é€šä¿—ç†è§£ï¼šä»€ä¹ˆæ˜¯â€œåŸæ ¹â€ï¼Ÿ

é¢˜ç›®ä¸­ç»™äº†ä¸‰ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬æ¥ç¿»è¯‘ä¸€ä¸‹ã€‚å‡è®¾æ¨¡æ•° $p$ æ˜¯ä¸€ä¸ªè´¨æ•°ï¼ˆæ¯”å¦‚ $p=7$ï¼‰ã€‚

+ **æ¡ä»¶ 1ï¼š** $1 < a < p$ã€‚ï¼ˆè¿™åªæ˜¯é™åˆ¶ $a$ çš„èŒƒå›´ï¼Œè¾“å…¥ä¿è¯äº†ï¼Œä¸ç”¨ç®¡ï¼‰
+ **æ¡ä»¶ 2ï¼š** $a^{p-1} \bmod p = 1$ã€‚ï¼ˆæ ¹æ®**è´¹é©¬å°å®šç†**ï¼Œåªè¦ $p$ æ˜¯è´¨æ•°ä¸” $a$ ä¸æ˜¯ $p$ çš„å€æ•°ï¼Œè¿™ä¸ªæ¡ä»¶**æ’æˆç«‹**ï¼Œæ‰€ä»¥ä¹Ÿä¸ç”¨ç‰¹æ„æ£€æŸ¥ï¼‰
+ **æ¡ä»¶ 3ï¼ˆæ ¸å¿ƒï¼‰ï¼š** å¯¹äºä»»æ„ $1 \le i < p-1$ï¼Œéƒ½æœ‰ $a^i \bmod p \neq 1$ã€‚

**é€šä¿—è§£é‡Šï¼š**
ä½ å¯ä»¥æŠŠ $a$ çœ‹ä½œä¸€ä¸ª**å‘ç”µæœº**ï¼Œå®ƒé€šè¿‡ä¸æ–­åœ°è‡ªä¹˜ï¼ˆ$a^1, a^2, a^3 \dots$ï¼‰åœ¨æ¨¡ $p$ çš„ä¸–ç•Œé‡Œç”Ÿæˆæ•°å­—ã€‚

+ $a$ çš„ $p-1$ æ¬¡æ–¹**å¿…é¡»**å›åˆ° 1ï¼ˆè¿™æ˜¯ç»ˆç‚¹ï¼‰ã€‚
+ ä½†æ˜¯ï¼Œ**åŸæ ¹**è¦æ±‚è¿™ä¸ªâ€œå‘ç”µæœºâ€å¿…é¡»è·‘å®Œæ•´ä¸ª $1$ åˆ° $p-1$ çš„æ‰€æœ‰è·¯ç¨‹ï¼Œ**æœ€åä¸€æ­¥**ï¼ˆç¬¬ $p-1$ æ­¥ï¼‰æ‰èƒ½å›åˆ° 1ã€‚
+ å¦‚æœå®ƒ**æå‰**ï¼ˆåœ¨ç¬¬ $i$ æ­¥ï¼Œå…¶ä¸­ $i < p-1$ï¼‰å°±å˜å›äº† 1ï¼Œé‚£å®ƒå°±å·æ‡’äº†ï¼Œå®ƒå°±**ä¸æ˜¯åŸæ ¹**ã€‚

**ä¸¾ä¸ªä¾‹å­ ($p=7$)ï¼š**
æˆ‘ä»¬è¦æ£€æŸ¥ $a=2$ æ˜¯ä¸æ˜¯åŸæ ¹ã€‚æˆ‘ä»¬éœ€è¦çœ‹ $2^1$ åˆ° $2^6$ã€‚

+ $2^1 \equiv 2$
+ $2^2 \equiv 4$
+ $2^3 \equiv 1$  ğŸ‘‰ **æ³¨æ„ï¼š**è¿™é‡Œ $2^3$ å°±å·²ç»æ˜¯ 1 äº†ã€‚
+ å› ä¸º $3 < 6$ï¼Œå®ƒæå‰å›åˆ°äº† 1ã€‚æ‰€ä»¥ 2 **ä¸æ˜¯** 7 çš„åŸæ ¹ã€‚

å†æ£€æŸ¥ $a=3$ï¼š

+ $3^1 \equiv 3$
+ $3^2 \equiv 2$
+ $3^3 \equiv 6$
+ $3^4 \equiv 4$
+ $3^5 \equiv 5$
+ $3^6 \equiv 1$ ğŸ‘‰ åªæœ‰åˆ°äº†æœ€åä¸€æ­¥ $p-1=6$ æ‰ç­‰äº 1ã€‚
+ ä¸­é—´æ²¡æœ‰æå‰å›åˆ° 1ï¼Œæ‰€ä»¥ 3 **æ˜¯** 7 çš„åŸæ ¹ã€‚

#### 2. è§£é¢˜æ€è·¯ï¼šå¦‚ä½•å¿«é€Ÿåˆ¤æ–­ï¼Ÿ

##### æš´åŠ›åšæ³•ï¼ˆä¼šè¶…æ—¶ï¼‰

æœ€ç›´æ¥çš„æƒ³æ³•æ˜¯å†™ä¸€ä¸ªå¾ªç¯ï¼Œä» $i = 1$ åˆ° $p-2$ï¼ŒæŒ¨ä¸ªè®¡ç®— $a^i \bmod p$ï¼Œçœ‹æ˜¯å¦ç­‰äº 1ã€‚

+ å¦‚æœæœ‰ä¸€ä¸ªç­‰äº 1ï¼Œè¾“å‡º Noã€‚
+ å¦‚æœéƒ½æ²¡æœ‰ï¼Œè¾“å‡º Yesã€‚

**é—®é¢˜ï¼š** $p$ æœ€å¤§æ˜¯ $10^9$ã€‚å¦‚æœä½ å¾ªç¯ $10^9$ æ¬¡ï¼Œç¨‹åºä¼šè·‘å¥½å‡ ç§’ç”šè‡³è¶…æ—¶ï¼ˆè®¡ç®—æœºä¸€ç§’å¤§æ¦‚è·‘ $10^8$ æ¬¡ï¼‰ã€‚

##### æ•°è®ºä¼˜åŒ–åšæ³•ï¼ˆæ­£è§£ï¼‰

æˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ªæ•°å­¦ç»“è®ºï¼š
**å¦‚æœ $a$ ä¼šâ€œæå‰â€å›åˆ° 1ï¼Œé‚£ä¹ˆå®ƒå›åˆ° 1 çš„æ­¥æ•°ï¼ˆæŒ‡æ•°ï¼‰ä¸€å®šæ˜¯ $p-1$ çš„çº¦æ•°ã€‚**

æ›´è¿›ä¸€æ­¥ï¼Œç»è¿‡æ¨å¯¼å¯ä»¥å¾—å‡ºåˆ¤å®šåŸæ ¹çš„**å……è¦æ¡ä»¶**ï¼š
å¯¹äº $p-1$ çš„**æ¯ä¸€ä¸ªè´¨å› æ•°** $q$ï¼Œå¦‚æœéƒ½æ»¡è¶³ï¼š
$$a^{\frac{p-1}{q}} \bmod p \neq 1$$
é‚£ä¹ˆ $a$ å°±æ˜¯åŸæ ¹ã€‚

**åªè¦æœ‰ä¸€ä¸ªè´¨å› æ•° $q$ ä½¿å¾— $a^{\frac{p-1}{q}} \bmod p = 1$ï¼Œé‚£ä¹ˆ $a$ å°±ä¸æ˜¯åŸæ ¹ã€‚**

è¿™æ ·ï¼Œç®—æ³•æ­¥éª¤å°±ç®€å•äº†ã€‚

#### 3. ç®—æ³•æ­¥éª¤

ä¸ºäº†åˆ¤æ–­ $a$ æ˜¯å¦ä¸º $p$ çš„åŸæ ¹ï¼Œæˆ‘ä»¬éœ€è¦åšä¸‰ä»¶äº‹ï¼š

1. **è®¡ç®— $X = p-1$ã€‚**
2. **å¯¹ $X$ è¿›è¡Œè´¨å› æ•°åˆ†è§£ã€‚**
    + æ‰¾å‡º $p-1$ çš„æ‰€æœ‰**ä¸åŒ**çš„è´¨å› å­ $q_1, q_2, \dots, q_k$ã€‚
    + ä¾‹å¦‚ï¼šå¦‚æœ $p=7$ï¼Œåˆ™ $p-1=6$ï¼Œè´¨å› å­æ˜¯ 2 å’Œ 3ã€‚
    + ä¾‹å¦‚ï¼šå¦‚æœ $p=17$ï¼Œåˆ™ $p-1=16 = 2^4$ï¼Œå”¯ä¸€çš„è´¨å› å­æ˜¯ 2ã€‚
3. **è¿›è¡Œå¿«é€Ÿå¹‚æ£€æµ‹ã€‚**(*è¿™éƒ¨åˆ†ç®—æ³•ï¼Œåç»­è¯¦ç»†ä»‹ç»ï¼Œå¸¸ç”¨ç®—æ³•*)
    + å¯¹äºæ¯ä¸€ä¸ªè´¨å› å­ $q$ï¼Œè®¡ç®— $val = a^{\frac{p-1}{q}} \bmod p$ã€‚
    + å¦‚æœå‘ç°æŸä¸ª $val == 1$ï¼Œè¯´æ˜å®ƒâ€œæå‰â€å›åˆ°äº† 1ï¼Œ**åˆ¤å®šå¤±è´¥ (No)**ã€‚
    + å¦‚æœæ‰€æœ‰è´¨å› å­æµ‹è¯•å®Œï¼Œéƒ½æ²¡æœ‰å‡ºç° 1ï¼Œ**åˆ¤å®šæˆåŠŸ (Yes)**ã€‚


---

### ç¤ºä¾‹ä»£ç 

```cpp
#include <algorithm>
#include <iostream>
#include <vector>

// å¿«é€Ÿå¹‚å–æ¨¡å‡½æ•°
// è®¡ç®— (base^exp) % mod
// ä½¿ç”¨ long long é˜²æ­¢ä¸­é—´ç»“æœæº¢å‡º
long long power_mod(long long base, long long exp, long long mod) {
    long long result = 1;
    base %= mod;
    while (exp > 0) {
        // å¦‚æœæŒ‡æ•°æ˜¯å¥‡æ•°ï¼Œå°†å½“å‰çš„ base ä¹˜å…¥ç»“æœ
        if (exp & 1) {
            result = result * base % mod;
        }
        // base è‡ªä¹˜ï¼ŒæŒ‡æ•°å³ç§»ä¸€ä½ï¼ˆé™¤ä»¥ 2ï¼‰
        base = base * base % mod;
        exp >>= 1;
    }
    return result;
}

int main() {
    // ä¼˜åŒ– I/O æ“ä½œ
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);

    int T;
    std::cin >> T;
    while (T--) {
        int a, p;
        std::cin >> a >> p;

        // æ¡ä»¶ 1: 1 < a < pï¼Œé¢˜ç›®æ•°æ®è‡ªç„¶æ»¡è¶³
        // æ¡ä»¶ 2: è´¹é©¬å°å®šç†ï¼šå¦‚æœ p æ˜¯è´¨æ•°ï¼Œåˆ™ a^(p-1) mod p = 1
        // æ’æˆç«‹ï¼Œé¢˜ç›®ä¿è¯ p æ˜¯è´¨æ•°ï¼Œè‡ªç„¶æ»¡è¶³ï¼Œæ— éœ€é¢å¤–åˆ¤æ–­ã€‚

        // æ¡ä»¶ 3 çš„ç­‰ä»·åˆ¤å®šï¼š
        // å¯¹äº p-1 çš„ä»»æ„è´¨å› æ•° qï¼Œå¦‚æœ a^((p-1)/q) mod p == 1ï¼Œåˆ™ a ä¸æ˜¯åŸæ ¹ã€‚
        // è¿™ç§æ–¹æ³•æ¯”æšä¸¾æ‰€æœ‰ 1 <= i < p-1 æ›´é«˜æ•ˆã€‚
        int target = p - 1;
        std::vector<int> primes;

        // åˆ†è§£è´¨å› æ•°ï¼šæ‰¾å‡º p-1 çš„æ‰€æœ‰ä¸åŒè´¨å› æ•°
        for (int i = 2; i * i <= target; i++) {
            if (target % i == 0) {
                primes.push_back(i);
                // é™¤å°½å½“å‰çš„è´¨å› å­ i
                while (target % i == 0) {
                    target /= i;
                }
            }
        }
        // å¦‚æœ target > 1ï¼Œè¯´æ˜å‰©ä¸‹çš„ target æœ¬èº«å°±æ˜¯ä¸€ä¸ªè´¨å› æ•°
        if (target > 1) {
            primes.push_back(target);
        }

        bool flag = true;
        // éå† p-1 çš„æ‰€æœ‰è´¨å› æ•° q
        for (int q : primes) {
            // è®¡ç®—æŒ‡æ•° (p-1)/q
            int tmp = (p - 1) / q;
            // æ£€æŸ¥ a^((p-1)/q) % p æ˜¯å¦ç­‰äº 1
            // å¦‚æœç­‰äº 1ï¼Œè¯´æ˜å­˜åœ¨æ›´å°çš„æŒ‡æ•°ä½¿å¾—åŒä½™ 1 æˆç«‹ï¼Œè¿ååŸæ ¹å®šä¹‰
            if (power_mod(a, tmp, p) == 1) {
                flag = false;
                break;
            }
        }

        if (flag) {
            std::cout << "Yes\n";
        } else {
            std::cout << "No\n";
        }
    }

    return 0;
}
```

---

